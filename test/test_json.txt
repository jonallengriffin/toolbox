Test toolbox JSON handling
==========================

Ensure we have no projects::

    >>> app.get('/')
    []

Make a project::

    >>> project = {'name': 'foo', 'description': 'bar', 'url': 'http://example.com'}
    >>> response = app.post('/new', params=project)
    >>> response.status
    303
    >>> newproject = app.get('/')[0]
    >>> modified = newproject.pop('modified')
    >>> project == newproject
    True

Add some fields to it::

    >>> fields = {'author': 'jhammel'}
    >>> url = '/' + project['name']
    >>> response = app.post(url, params=fields)
    >>> app.get('/')[0]['author']
    [u'jhammel']
    >>> fields = {'author': 'turing'}
    >>> response = app.post(url, params=fields)
    >>> sorted(app.get('/')[0]['author'])
    [u'jhammel', u'turing']

Now let's search for the project!::

    >>> authors = app.get('/author')
    >>> len(authors)
    2
    >>> authors['jhammel']
    [u'foo']
    >>> authors['turing']
    [u'foo']

Let's search for it a different way::

    >>> project = app.get('/')[0]
    >>> projects = app.get('/', params={'author': 'jhammel'})
    >>> newproject = projects[0]
    >>> newproject == project
    True

Just to show that the search is doing something::

    >>> app.get('/', params={'author': 'sauron'})
    []
