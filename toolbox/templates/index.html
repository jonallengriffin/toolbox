<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>{{title}}</title>
<script src="{{link('/js/jquery.js')}}"></script>
<script src="{{link('/js/jquery.jeditable.js')}}"></script>
<script type="text/javascript">
$(document).ready(function(){
$('div.project').each(function(){
var project = $(this).attr('id'); 
//$(this).find('p.description').each(function(){alert($(this).html())});
$(this).find('p.description').editable(project, {
'type': 'textarea',
'rows': 7,
'indicator': '<img href="/img/indicator.gif"/>',
'onblur': 'submit',
'name': 'description',
});
});
});
</script>
</head>
<body>

{{navigation | html}}

{{if len(projects) > 1}}
<h1>{{len(projects)}} projects</h1>
{{endif}}

{{for project in projects}}
  <div class="project" id="{{project['name']}}">
    <a name="{{project['name']}}"></a>
    <h1>
      {{if 'url' in project}}
      <a href="{{project['url']}}">{{project['name']}}</a>
      {{else}}
      {{project['name']}}
      {{endif}}
    </h1>
    <span class="date">Modified: {{format_date(project['modified'])}}</span>
    <p class="description">{{project.get('description', '')}}</p>
    {{for field in [f for f in fields if f in project]}}
    <ul class="{{field}}">
      <h2><a href="{{link(field)}}">{{field.title()}}</a></h2>
      {{for entry in project[field]}}
      <li><a href="?{{field}}={{entry}}">{{entry}}</a></li>
      {{endfor}}
    </ul>
    {{endfor}}

    <!-- project deletion -->
    <form action={{link('delete')}} method="POST">
      <button type="submit" name="project" value="{{project['name']}}">
        Delete
      </button>
    </form>
  </div><!-- project -->
{{endfor}}  
</body>
</html>
